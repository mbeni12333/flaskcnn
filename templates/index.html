<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../static/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
    <title></title>
</head>

<body>

    <div class="page">
        <img src="../static/img/hd.jpg" alt="image">
        <div class="filter"></div>
        <div class="text">
            <p class="page_title">what is Convolutional Neural Network ?
                <p>
                    <p class="page_desc">Learn how to train a cnn, and deploy it using pytorch
                        <p>
        </div>
    </div>
    <nav>
        <ul>
            <li class="selected"    ><a href="#">HOME<span></span></a></li>
            <li ><a href="#technology" >Technology<span></span></a></li>
            <li><a href="#how">How <span></span></a></li>
            <li><a href="#demo">Demo <span></span></a></li>
            <li><a href="#conclusion">Conclusion <span></span></a></li>
        </ul>
    </nav>
    <div class="demotxt">
        <h1>Technology used </h1>
        <p>This are the technilogies used to build this project</p>
    </div>
    <div class="Technology" id="technology">

        <div class="card"><img src="../static/img/flask.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/pytorch.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/python.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/html.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/json.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/pickle.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/jupyter.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/numpy.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/plt.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/git.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/heroku.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
        <div class="card"><img src="../static/img/js.png" class="card_logo"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorum vel, adipisci harum mollitia, commodi cum dolore dolores et ratione temporibus neque qui! Esse, repudiandae. Itaque minima doloremque accusantium voluptatum, molestias?</p>
        </div>
    </div>
    <br>
    <hr size="5">
    <div class="demotxt">
        <h1>Let's start ! </h1>
        <p>the main subject of this post </p>
    </div>
    <div class="content">
        <section>
            <p>Before starting to dive into this article, I just want to let you know that if you are into deep learning, I believe you should also check my other article Predict Tomorrow’s Bitcoin (BTC) Price with Recurrent Neural Networks. I used an RNN to predict BTC prices and since it uses an API, the results always remain up-to-date. When you start learning deep learning with neural network, you realize that one of the most powerful supervised deep learning techniques is the Convolutional Neural Networks (abbreviated as “CNN”). The final structure of a CNN is actually very similar to Regular Neural Networks (RegularNets) where there are neurons with weights and biases. In addition, just like in RegularNets, we use a loss function (e.g. crossentropy or softmax) and an optimizer (e.g. adam optimizer) in CNNs [2]. Additionally though, in CNNs, there are also Convolutional Layers, Pooling Layers, and Flatten Layers. CNNs are mainly used for image classification although you may find other application areas such as natural language processing.
            </p>
        </section>

        <section>
            <h2>Why Convolutional Neural Networks</h2>
            <p>
                The main structural feature of RegularNets is that all the neurons are connected to each other. For example, when we have images with 28 by 28 pixels with only greyscale, we will end up having 784 (28 x 28 x 1) neurons in a layer which seems manageable. However, most images have way more pixels and they are not grey-scaled. Therefore, assuming that we have a set of color images in 4K Ultra HD, we will have 26,542,080 (4096 x 2160 x 3) different neurons connected to each other in the first layer which is not really manageable. Therefore, we can say that RegularNets are not scalable for image classification. However, especially when it comes to images, there seems to be little correlation or relation between two individual pixels unless they are close to each other. This leads to the idea of Convolutional Layers and Pooling Layers. Layers in a CNN We are capable of using many different layers in a convolutional neural network. However, convolution, pooling, and fully connect layers are the most important ones. Therefore, I will quickly introduce these layers before implementing them.
            </p>
        </section>
        <section>
            <h2>Convolutional Layers</h2>
            <p>
                Convolutional layer is the very first layer where we extract features from the images in our datasets. Due to the fact that pixels are only related with the adjacent and close pixels, convolution allows us to preserve the relationship between different parts of an image. Convolution is basically filtering the image with a smaller pixel filter to decrease the size of the image without loosing the relationship between pixels. When we apply convolution to 5x5 image by using a 3x3 filter with 1x1 stride (1 pixel shift at each step). We will end up having a 3x3 output (64% decrease in complexity). Figure 1: Convolution of 5 x 5 pixel image with 3 x 3 pixel filter (stride = 1 x 1 pixel) Pooling Layer When constructing CNNs, it is common to insert pooling layers after each convolution layer to reduce the spatial size of the representation to reduce the parameter counts which reduces the computational complexity. In addition, pooling layers also helps with the overfitting problem. Basically we select a pooling size to reduce the amount of the parameters by selecting the maximum, average, or sum values inside these pixels. Max Pooling, one of the most common pooling techniques, may be demonstrated as follows:
            </p>
        </section>

        <section>
            <h2>Max Pooling by 2 x 2</h2>
            <p>
                A Set of Fully Connected Layers A fully connected network is our RegularNet where each parameter is linked to one another to determine the true relation and effect of each parameter on the labels. Since our time-space complexity is vastly reduced thanks to convolution and pooling layers, we can construct a fully connected network in the end to classify our images. A set of fully connected layers looks like this: A fully connected layer with two hidden layers Now that you have some idea about the individual layers that we will use, I think it is time to share an overview look of a complete convolutional neural network. A Convolutional Neural Network Example [3] And now that you have an idea of convolutional neural network that you can build for image classification, we can get the most cliche dataset for classification: MNIST dataset, which stands for Modified National Institute of Standards and Technology database. It is a large database of handwritten digits that is commonly used for training various image processing systems.
            </p>
        </section>
        <section>
            <h2>Downloading the Mnist Data</h2>
            <p>
                The MNIST dataset is one of the most common datasets used for image classification and accessible from many different sources. In fact, even Tensorflow and Keras allow us to import and download the MNIST dataset directly from their API. Therefore, I will start with the following two lines to import tensorflow and MNIST dataset under the Keras API. The MNIST database contains 60,000 training images and 10,000 testing images taken from American Census Bureau employees and American high school students [4]. Therefore, in the second line, I have separated these two groups as train and test and also separated the labels and the images. x_train and x_test parts contain greyscale RGB codes (from 0 to 255) while y_train and y_test parts contains labels from 0 to 9 which represents which number they actually are. To visualize these numbers, we can get help from matplotlib. When we run the code above, we will get the greyscale visualization of the RGB codes as shown below. A visualization of the sample image at index 7777 We also need to know the shape of the dataset to channel it to the convolutional neural network. Therefore, I will use the “shape” attribute of numpy array with the following code: You will get (60000, 28, 28). As you might have guessed 60000 represents the number of images in the train dataset and (28, 28) represents the size of the image: 28 x 28 pixel. Reshaping and Normalizing the Images To be able to use the dataset in Keras API, we need 4-dims numpy arrays. However, as we see above, our array is 3-dims. In addition, we must normalize our data as it is always required in neural network models. We can achieve this by dividing the RGB codes to 255 (which is the maximum RGB code minus the minimum RGB code). This can be done with the following code:

            </p>
        </section>
        <section>
            <h2>Building the Convolutional Neural Network</h2>
            <p>
                We will build our model by using high level Keras API which uses either TensorFlow or Theano on the backend. I would like to mention that there are several high level TensorFlow APIs such as Layers, Keras, and Estimators which helps us create neural networks with high level knowledge. However, this may lead to confusion since they all varies in their implementation structure. Therefore, if you see completely different codes for the same neural network although they all use tensorflow, this is why. I will use the most straightforward API which is Keras. Therefore, I will import the Sequential Model from Keras and add Conv2D, MaxPooling, Flatten, Dropout, and Dense layers. I have already talked about Conv2D, Maxpooling, and Dense layers. In addition, Dropout layers fight with the overfitting by disregarding some of the neurons while training while Flatten layers flatten 2D arrays to 1D array before building the fully connected layers. We may experiment with any number for the first Dense layer; however, the final Dense layer must have 10 neurons since we have 10 number classes (0, 1, 2, …, 9). You may always experiment with kernel size, pool size, activation functions, dropout rate, and number of neurons in the first Dense layer to get a better result.
            </p>
        </section>
        <section>
            <h2>Compiling and Fitting the Model</h2>
            <p>
                With the above code, we created an non-optimized empty CNN. Now it is time to set an optimizer with a given loss function which uses a metric. Then, we can fit the model by using our train data. We will use the following code for these tasks: You can experiment with the optimizer, loss function, metrics, and epochs. However, I can say that adam optimizer is usually out-performs the other optimizers. I am not sure if you can actually change the loss function for multi-class classification. Feel free to experiment and comment below. Epoch number might seem a bit small. However, you will reach to 98–99% test accuracy. Since the MNIST dataset does not require heavy computing power, you may easily experiment with the epoch number as well.
            </p>
        </section>
        <section>
            <h2>Evaluating the Model</h2>
            <p>
                Finally, you may evaluate the trained model with x_test and y_test using one line of code: The results are pretty good for 10 epochs and for such simple model. Evaluation shows 98.5% accuracy on test set! We achieved 98.5% accuracy with such basic model. To be frank, in many image classification cases (e.g. for autonomous cars), we cannot even tolerate 0.1% error since, as an analogy, it will cause 1 accident in 1000 cases. However, for our first model, I would say the result is still pretty good. We can also make individual predictions with the following code: Our model will classify the image as a ‘9’ and here is the visual of the image: Our model correctly classifies this image as a 9 (Nine) Although it is not really a good hand writing of the number 9, our model was able to classify it as 9. Congratulations! You have successfully built a convolutional neural network to classify hand written digits with Tensorflow’s Keras API. You have achieved an accuracy over 98% and now you can even save this model & create a digit-classifier app! If you are curious about saving your model, I would like to direct you to the Keras Documentation. After all, to be able to efficiently use an API, one must learn how to read and use the documentation. Resources [1] KataKoda, https://www.katacoda.com/basiafusinska/courses/tensorflow-getting-started/tensorflow-mnist-beginner [2] CS231n Convolutional Neural Networks for Visual Recognition (http://cs231n.github.io/convolutional-networks/) [3] MathWorks, Introducing Deep Learning with MATLAB, https://www.mathworks.com/content/dam/mathworks/tag-team/Objects/d/80879v00_Deep_Learning_ebook.pdf [4] Wikipedia, MNIST database, https://en.wikipedia.org/wiki/MNIST_database</p>
        </section>
    </div>
    <hr size="5" />
    <div class="demotxt" id="demo">
        <h1>Try it yourself !</h1>
        <p>Try this component, draw a character and then hit predict to see the prediction probabilities </p>
    </div>
    <div class="demo">
        <div class="canvas">
            <canvas id="canvas" width="400" height="400" style="background-color:white"></canvas>
            <button class="clear" id="clear_btn" type="button" name="clear">Clear</button>
            <button class="predict" id="predict_btn" type="button" name="predict">Predict</button>
        </div>

        <div class="predictions">
            <div id="doughnutChart" class="chart"></div>
        </div>
    </div>
    <footer>
        <div class="primary">
            <div class="items">
                <p>contact</p>
                <ul>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                </ul>
            </div>
            <div class="items">
                <p>contact</p>
                <ul>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                </ul>
            </div>
            <div class="items">
                <p>contact</p>
                <ul>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                    <li><a href="#">thisisatest</a></li>
                </ul>
            </div>
        </div>
        <div class="secondary">
            <p class="made">Made with ❤️ by Mounib Benimam</p>
        </div>
    </footer>

    <script src="../static/js/canvas.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="../static/js/pie.js"></script>
    <script src="../static/js/predict.js"></script>
    <script>
        
        $("li").click(function(){
            $(".selected").removeClass("selected");
            $(this).addClass("selected");
        });
    </script>
</body>

</html>